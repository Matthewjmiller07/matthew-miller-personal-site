---
import Layout from '../layouts/Layout.astro';
import LinkIcon from '../components/icons/LinkIcon.astro'; // Assuming you have this from media-appearances

// Define your projects
// You can add a brief description for each later if you like
const githubUsername = "matthewjmiller07"; // ** VERIFY YOUR GITHUB USERNAME **

const projects = [
    { name: "bibleMap", description: "Interactive map of biblical locations." },
    { name: "Colors", description: "A color utility or exploration tool." },
    { name: "CompaniesHouseMap", description: "Mapping data from Companies House." },
    { name: "Crypto", description: "A cryptocurrency related project." },
    { name: "G2researchmethodology", description: "Showcasing G2's research methodology." },
    { name: "github-slideshow", description: "A slideshow tool for GitHub content." },
    { name: "HaftaraStats", description: "Statistics and visualizations for Haftara readings." },
    { name: "Jewish-JS", description: "JavaScript utilities for Jewish texts or calculations." },
    { name: "leviticus-quiz", description: "A quiz on the Book of Leviticus." },
    { name: "LiteraryBible", description: "Exploring literary devices in the Bible (Color-Coded Bible)." },
    { name: "micrography", description: "Generates micrography from images and text." },
    { name: "neigh2", description: "A neighborhood or social data project." },
    { name: "Omer", description: "Tool for counting the Omer." },
    { name: "Parsha-Explorer", description: "In-depth exploration of biblical parshas." },
    { name: "Particles", description: "A particle animation or simulation." },
    { name: "pinmap", description: "Track and share visited locations on a map." },
    { name: "rebbe", description: "A project related to a Rebbe or Chassidic thought." },
    { name: "SefariaMemory", description: "Memory quiz for Hebrew texts from Sefaria (Memory Quiz)." },
    { name: "Tesla-Cost-Calculator", description: "Calculates Tesla ownership costs." },
    { name: "TorahScheduler", description: "Create custom Torah and Mishnah study schedules." },
    { name: "uscities", description: "Interactive map of US and UK cities with shared names." },
    { name: "whenarethejewishholidays", description: "Interactive Jewish holiday calendar." },
    { name: "xaastracker", description: "Tracking examples of XaaS (Everything as a Service)." },
    { name: "Zmanim", description: "Zmanim lookup (possibly an earlier version or related)." }
].map(project => ({
    ...project,
    url: `https://${githubUsername}.github.io/${project.name}/`
}));

// Separate list for your "Jewish Projects" and "Data Projects" from Squarespace content
// This is for the projects that WILL BE subdomains later.
// For now, these also link to GH Pages if they are the same. Adjust if they are different.
// PDF Projects
const pdfProjects = [
    {
        name: "Interlinear Bible",
        description: "Beautiful PDF of Tanach chapters in bilingual format.",
        downloadUrl: "/books/Interlinear-Bible-Book.pdf",
        previewImage: "/images/Interlinear Bible.gif",
        category: "Jewish Studies"
    },
    {
        name: "Mevakshim Book",
        description: "The Mevakshim Book is a compilation of insights, summaries, and reflections drawn from the shiurim delivered during the Boca Raton Synagogue (BRS) Mevakshim Fly-In on May 23, 2025. It captures the powerful teachings and inspirational messages of some of todayâ€™s leading Torah giants, offering a window into their unique hashkafot and spiritual guidance.",
        rabbanim: [
          "Rav Betzalel Rudinsky",
          "Rav Chaim Aryeh Zev Ginzberg",
          "Rav Daniel Kalish",
          "Rav Ephraim Wachsman",
          "Rav Mordechai Finkelman",
          "Rav Moshe Don Kestenbaum",
          "Rav Ron Yitzchok Eisenman",
          "Reb Ralph Rieder",
          "Rav Yisroel Dovid Schlesinger",
          "Rav Moshe Leib Rabinovich",
          "Rav Yisroel Reisman",
          "Rav Yitzchok Lichtenstein",
          "Rav Avrohom Schorr"
        ],
        descriptionAfter: "The book serves as a meaningful record of the event, preserving the depth and emotion of the experience while inspiring continued growth for those who learn from it.",
        downloadUrl: "/books/Mevakshim Book.pdf",
        previewImage: "/images/Mevakshim Book.gif",
        category: "Jewish Studies"
    }
];

const featuredProjectsInfo = [
    // Jewish Projects
    { name: "Memory Quiz (SefariaMemory)", repoName: "SefariaMemory", description: "Memorize Hebrew texts from Sefaria.", category: "Jewish Studies", isSubdomain: true, previewImage: "/images/previews/MemoryQuiz.png" },
    { name: "Haftara Stats", repoName: "HaftaraStats", description: "Visualize Haftarah readings across rites.", category: "Jewish Studies", isSubdomain: true, previewImage: "/images/previews/HaftaraStats.png" },
    { name: "Biblical & US/UK City Names Map", repoName: "MegaMap", description: "Interactive map of Biblical locations and US/UK cities.", category: "Jewish Studies", isSubdomain: true, previewImage: "/images/previews/MegaMap.png" }, // Assuming bibleMap is this
    { name: "Micrography", repoName: "micrography", description: "Recreate images using chosen text.", category: "Jewish Studies", isSubdomain: true, previewImage: "/images/previews/micrographymatthew.jpeg" },
    { name: "Zmanim Tracker (New-Zmanim)", repoName: "New-Zmanim", description: "Advanced Zmanim lookup and comparison.", category: "Jewish Studies", isSubdomain: true, previewImage: "/images/previews/zmanim.gif" },
    { name: "Parsha Explorer", repoName: "Parsha-Explorer", description: "In-depth exploration of biblical texts.", category: "Jewish Studies", isSubdomain: true, previewImage: "/images/previews/parshaexplorer.gif" },
    { name: "Torah Schedule Creator", repoName: "TorahScheduler", description: "Customized Torah and Mishnah study schedules.", category: "Jewish Studies", isSubdomain: true, previewImage: "/images/previews/torahscheduler.gif" },
    { name: "When are the Jewish Holidays", repoName: "whenarethejewishholidays", description: "Explore Jewish holidays interactively.", category: "Jewish Studies", isSubdomain: true, previewImage: "/images/previews/whenarethejewishholidays.gif" },
    { name: "Literary Bible (Color-Coded Bible)", repoName: "LiteraryBible", description: "Explore the Hebrew Bible with highlighted literary devices.", category: "Jewish Studies", isSubdomain: true, previewImage: "/images/previews/colorcodedbible.gif" },
    // Data Projects
    // Micrography is already listed above
    { name: "Pinmap (Travel Tracker)", repoName: "pinmap", description: "Track and share cities, states, and countries visited.", category: "Data Viz", isSubdomain: true, previewImage: "/images/previews/pinmap.gif" },
].map(p => ({
    ...p,
    // For now, link to GitHub pages. Later, these will be subdomains.
    url: `https://${githubUsername}.github.io/${p.repoName}/`,
    // When subdomains are ready:
    // url: p.isSubdomain ? `https://${p.repoName.toLowerCase()}.yourcustomdomain.com` : `https://${githubUsername}.github.io/${p.repoName}/`
}));

const allDisplayProjects = [...new Map([...featuredProjectsInfo, ...projects].map(item => [item.name, item])).values()];
// This de-duplicates by name, giving preference to featuredProjectsInfo if names overlap.
---

<Layout
    title="My Projects"
    description="A showcase of Matthew Miller's diverse projects, ranging from tech innovations and data visualizations to in-depth Jewish studies tools."
>
    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-12 sm:py-16">
        <header class="mb-12 text-center">
            <h1 class="text-4xl font-extrabold tracking-tight text-primary-light dark:text-primary-dark sm:text-5xl">
                Projects Showcase
            </h1>
            <p class="mt-4 text-lg text-secondary-light dark:text-secondary-dark max-w-2xl mx-auto">
                Explore a collection of my work, including tools for Jewish studies, data visualizations, and various tech experiments.
            </p>
        </header>

        {/* Book Downloads Section */}
        <section class="mb-16">
            <h2 class="text-3xl font-bold tracking-tight text-primary-light dark:text-primary-dark mb-8 text-center sm:text-left">
                Books
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 lg:gap-8">
                {pdfProjects.map(project => (
    <div class="bg-card-bg-light dark:bg-card-bg-dark rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow duration-300 flex flex-col group hover:bg-accent transition-colors">
        <h3 class="text-lg font-bold text-primary-light dark:text-primary-dark mb-2 px-4 pt-4 group-hover:text-white transition-colors">{project.name}</h3>
        <a href={project.downloadUrl} download class="block aspect-w-16 aspect-h-9 group focus:outline-none">
            <img 
                src={project.previewImage} 
                alt={`Preview of ${project.name}`}
                class="object-cover w-full h-full group-hover:opacity-80 transition-opacity duration-200"
                loading="lazy"
            />
            <span class="sr-only">Download {project.name} PDF</span>
        </a>
        <div class="p-4 pt-3 text-sm">
            <p class="text-secondary-light dark:text-secondary-dark mb-2 leading-snug group-hover:text-white transition-colors">{project.description}</p>
            {project.rabbanim && (
                <>
                    <p class="mb-1 font-semibold text-primary-light dark:text-primary-dark text-xs group-hover:text-white transition-colors">Featured rabbanim include:</p>
                    <ul class="list-disc pl-5 mb-2 text-secondary-light dark:text-secondary-dark text-xs group-hover:text-white transition-colors">
                        {project.rabbanim.map(rabbi => <li>{rabbi}</li>)}
                    </ul>
                </>
            )}
            {project.descriptionAfter && (
                <p class="text-secondary-light dark:text-secondary-dark text-xs group-hover:text-white transition-colors">{project.descriptionAfter}</p>
            )}
            <a 
                href={project.downloadUrl}
                class="inline-flex items-center px-3 py-1.5 mt-2 bg-accent hover:bg-accent/90 text-white rounded-md text-xs transition-colors duration-200 group-hover:bg-accent group-hover:text-white"
                download
            >
                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                </svg>
                Download PDF
            </a>
        </div>
    </div>
))}
            </div>
        </section>

        {/* Section for projects that will become subdomains */}
        <section class="mb-16">
            <h2 class="text-3xl font-bold tracking-tight text-primary-light dark:text-primary-dark mb-8 text-center sm:text-left">
                Featured Projects
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 lg:gap-8">
                {featuredProjectsInfo.filter(p => p.isSubdomain).map(project => (
                    <a href={project.url} target="_blank" rel="noopener noreferrer"
                       class="block p-6 rounded-xl shadow-lg hover:shadow-2xl border border-border-light dark:border-border-dark transform hover:-translate-y-1 transition-all duration-200 group relative bg-accent text-white">
                        {/* Category badge - moved to prevent overlap */}
                        {project.category && (
                            <div class="flex justify-end mb-2">
                                <span class="text-xs bg-accent-light/80 text-white px-2 py-0.5 rounded-full font-medium">
                                    {project.category}
                                </span>
                            </div>
                        )}
                        {/* Preview Image */}
                        {project.previewImage && (
                          <img
                            src={project.previewImage}
                            alt={`Preview of ${project.name}`}
                            class="mb-4 rounded shadow max-h-48 w-full object-cover"
                            loading="lazy"
                          />
                        )}
                        <h3 class="text-xl font-semibold mb-2 text-white group-hover:underline leading-tight">
                            {project.name}
                        </h3>
                        {project.description && (
                            <p class="text-sm text-secondary-light dark:text-secondary-dark mb-3 leading-relaxed">
                                {project.description}
                            </p>
                        )}
                        <div class="flex items-center text-xs text-accent-light font-medium mt-auto group-hover:underline">
                            View Project
                            <LinkIcon class="w-3.5 h-3.5 ml-1.5 group-hover:translate-x-0.5 transition-transform" />
                        </div>
                    </a>
                ))}
            </div>
            <p class="text-center mt-8 text-sm text-secondary-light dark:text-secondary-dark">
                These applications are currently hosted on GitHub Pages and will be moved to subdomains of my custom domain soon.
            </p>
        </section>

        {/* Section for other GitHub projects */}
        <section>
            <h2 class="text-3xl font-bold tracking-tight text-primary-light dark:text-primary-dark mb-8 text-center sm:text-left">
                More GitHub Repositories
            </h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6">
                {projects.filter(p => !featuredProjectsInfo.find(fp => fp.name === p.name && fp.isSubdomain)).map(project => (
                    <a href={project.url} target="_blank" rel="noopener noreferrer"
                       class="block p-4 bg-card-bg-light dark:bg-card-bg-dark rounded-lg shadow-md hover:shadow-xl border border-border-light dark:border-border-dark transform hover:-translate-y-0.5 transition-all duration-150 group">
                        <h3 class="text-md font-semibold mb-1 text-primary-light dark:text-primary-dark group-hover:text-accent dark:group-hover:text-accent-dark leading-snug">
                            {project.name}
                        </h3>
                        {project.description && project.description.length > 50 ? ( // Show shorter desc for these smaller cards
                             <p class="text-xs text-secondary-light dark:text-secondary-dark mb-2 leading-snug truncate-2-lines">{project.description}</p>
                        ) : project.description ? (
                             <p class="text-xs text-secondary-light dark:text-secondary-dark mb-2 leading-snug">{project.description}</p>
                        ): null}
                        <div class="flex items-center text-xs text-accent dark:text-accent-dark font-medium">
                            View on GitHub
                            <LinkIcon class="w-3 h-3 ml-1 group-hover:translate-x-0.5 transition-transform" />
                        </div>
                    </a>
                ))}
            </div>
        </section>
    </main>
</Layout>

<style>
/* Helper for truncating text to a specific number of lines */
.truncate-2-lines {
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 2; /* number of lines to show */
    -webkit-box-orient: vertical;
}
</style>